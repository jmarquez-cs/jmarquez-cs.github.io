import{r as i}from"./index-DhFFnUky.js";const h=c=>{const[s,r]=i.useState({renderTime:0,memoryUsage:0,bundleSize:0,loadTime:0,interactionTime:0}),d=i.useRef(null),g=i.useRef(Date.now());i.useEffect(()=>{const n=Date.now()-g.current;r(m=>({...m,loadTime:n}))},[]),i.useEffect(()=>("PerformanceObserver"in window&&(d.current=new PerformanceObserver(n=>{n.getEntries().forEach(t=>{t.entryType==="resource"&&(t.name.includes("chunk")||t.name.includes(".js"))&&r(o=>({...o,bundleSize:o.bundleSize+(t.transferSize||0)})),t.entryType==="paint"&&t.name==="first-contentful-paint"&&r(o=>({...o,renderTime:t.startTime})),t.entryType==="navigation"&&r(o=>({...o,loadTime:t.loadEventEnd-t.loadEventStart})),t.entryType==="event"&&r(o=>({...o,interactionTime:t.processingEnd-t.processingStart}))})}),d.current.observe({entryTypes:["resource","paint","navigation","event"]})),()=>{d.current&&d.current.disconnect()}),[]),i.useEffect(()=>{const n=()=>{"memory"in performance&&r(t=>({...t,memoryUsage:performance.memory.usedJSHeapSize}))},m=setInterval(n,5e3);return n(),()=>clearInterval(m)},[]);const f=i.useCallback(()=>s,[s]),a=i.useCallback((n,m={})=>{},[s,c]),l=i.useRef(f);l.current=f;const e=i.useRef(a);return e.current=a,i.useMemo(()=>({renderTime:s.renderTime,memoryUsage:s.memoryUsage,bundleSize:s.bundleSize,loadTime:s.loadTime,interactionTime:s.interactionTime,getMetrics:()=>l.current(),record:(...n)=>e.current(...n)}),[s.renderTime,s.memoryUsage,s.bundleSize,s.loadTime,s.interactionTime])},T=()=>{const[c,s]=i.useState({totalSize:0,compressedSize:0,chunks:[],dependencies:{},loadingTimes:{},cacheEfficiency:0});return i.useEffect(()=>{if("PerformanceObserver"in window){const r=new PerformanceObserver(d=>{const a=d.getEntries().filter(e=>e.name.endsWith(".js")||e.name.includes("chunk")).reduce((e,u)=>{const n=u.transferSize||0,m=u.encodedBodySize||0,t=u.duration||0,o=u.name.split("/").pop();if(e.totalSize+=n,e.compressedSize+=m,e.loadingTimes[o]=t,e.chunks.push({name:o,fullPath:u.name,size:n,compressedSize:m,loadTime:t,compressionRatio:n>0?((n-m)/n*100).toFixed(1):0,cached:u.transferSize===0&&u.decodedBodySize>0}),u.name.includes("node_modules")||u.name.includes("vendor")){const p=o.split(".")[0];e.dependencies[p]=(e.dependencies[p]||0)+n}return e},{totalSize:0,compressedSize:0,chunks:[],dependencies:{},loadingTimes:{}}),l=a.chunks.filter(e=>e.cached).length;a.cacheEfficiency=a.chunks.length>0?(l/a.chunks.length*100).toFixed(1):0,s(e=>({...e,...a}))});return r.observe({entryTypes:["resource"]}),()=>r.disconnect()}},[]),c},z=()=>{const[c,s]=i.useState({totalBudget:5e5,chunkBudget:2e5,warnings:[],passed:!0}),{totalSize:r,chunks:d}=T();return i.useEffect(()=>{const g=[];let f=!0;r>c.totalBudget&&(g.push(`Total bundle size (${(r/1024).toFixed(1)}KB) exceeds budget (${(c.totalBudget/1024).toFixed(1)}KB)`),f=!1);const a=d.reduce((l,e)=>e.size>l.size?e:l,{size:0});a.size>c.chunkBudget&&(g.push(`Largest chunk (${(a.size/1024).toFixed(1)}KB) exceeds budget (${(c.chunkBudget/1024).toFixed(1)}KB)`),f=!1),s(l=>({...l,warnings:g,passed:f}))},[r,d,c.totalBudget,c.chunkBudget]),c};export{T as a,z as b,h as u};
