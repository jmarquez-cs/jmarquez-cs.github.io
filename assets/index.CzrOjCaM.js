import{a as t,b as e}from"./scalable-cuckoo-filter.BKNYiDuL.js";function n(e,n){let o=0;if(null!=e[Symbol.asyncIterator])return async function*(){for await(const t of e)await n(t,o++)&&(yield t)}();const r=t(e),{value:c,done:i}=r.next();if(!0===i)return function*(){}();const s=n(c,o++);if("function"==typeof s.then)return async function*(){await s&&(yield c);for(const t of r)await n(t,o++)&&(yield t)}();const l=n;return function*(){!0===s&&(yield c);for(const t of r)l(t,o++)&&(yield t)}()}function o(t){if(null!=t[Symbol.asyncIterator])return(async()=>{const e=[];for await(const n of t)e.push(n);return e})();const e=[];for(const n of t)e.push(n);return e}function r(t){if("object"!=typeof t||null===t)return!1;const e=Object.getPrototypeOf(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)}const{hasOwnProperty:c}=Object.prototype,{propertyIsEnumerable:i}=Object,s=(t,e,n)=>{Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})},l={concatArrays:!1,ignoreUndefined:!1},a=t=>{const e=[];for(const n in t)c.call(t,n)&&e.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(t);for(const o of n)i.call(t,o)&&e.push(o)}return e};function f(t){return Array.isArray(t)?function(t){const e=t.slice(0,0);return a(t).forEach(n=>{s(e,n,f(t[n]))}),e}(t):r(t)?function(t){const e=null===Object.getPrototypeOf(t)?Object.create(null):{};return a(t).forEach(n=>{s(e,n,f(t[n]))}),e}(t):t}const u=(t,e,n,o)=>(n.forEach(n=>{void 0===e[n]&&o.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?s(t,n,p(t[n],e[n],o)):s(t,n,f(e[n])))}),t),y=(t,e,n)=>{let o=t.slice(0,0),r=0;return[t,e].forEach(e=>{const i=[];for(let n=0;n<e.length;n++)c.call(e,n)&&(i.push(String(n)),s(o,r++,e===t?e[n]:f(e[n])));o=u(o,e,a(e).filter(t=>!i.includes(t)),n)}),o};function p(t,e,n){return n.concatArrays&&Array.isArray(t)&&Array.isArray(e)?y(t,e,n):r(e)&&r(t)?u(t,e,a(e),n):f(e)}function d(...t){const e=p(f(l),undefined!==this&&this||{},l);let n={_:{}};for(const o of t)if(void 0!==o){if(!r(o))throw new TypeError("`"+o+"` is not an Option Object");n=p(n,{_:o},e)}return n._}const h=globalThis.CustomEvent??Event;async function*b(t,n={}){let o=n.concurrency??1/0;o<1&&(o=1/0);const r=n.ordered??!1,c=new EventTarget,i=[];let s,l=e(),a=e(),f=!1,u=!1;function y(){var t;return r?null==(t=i[0])?void 0:t.done:Boolean(i.find(t=>t.done))}function*p(){for(;i.length>0&&i[0].done;){const t=i[0];if(i.shift(),!t.ok)throw u=!0,l.resolve(),t.err;yield t.value,l.resolve()}}function*d(){for(;y();)for(let t=0;t<i.length;t++)if(i[t].done){const e=i[t];if(i.splice(t,1),t--,!e.ok)throw u=!0,l.resolve(),e.err;yield e.value,l.resolve()}}for(c.addEventListener("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(const n of t){if(i.length===o&&(l=e(),await l.promise),u)break;const t={done:!1};i.push(t),n().then(e=>{t.done=!0,t.ok=!0,t.value=e,c.dispatchEvent(new h("task-complete"))},e=>{t.done=!0,t.err=e,c.dispatchEvent(new h("task-complete"))})}f=!0,c.dispatchEvent(new h("task-complete"))}catch(n){s=n,c.dispatchEvent(new h("task-complete"))}});;){if(y()||(a=e(),await a.promise),null!=s)throw s;if(r?yield*p():yield*d(),null!=s)throw s;if(f&&0===i.length)break}}export{o as a,n as f,d as m,b as p};
