const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.BLRXELsa.js","assets/react-vendor.BcUHAtgm.js","assets/mermaid-core.B8ycMFPP.js","assets/icons.r1cMsEGh.js"])))=>i.map(i=>d[i]);
import{R as e,r as t}from"./react-vendor.BcUHAtgm.js";import{P as n,u as r,a,b as o}from"./index.BLRXELsa.js";import{a3 as i}from"./mermaid-core.B8ycMFPP.js";import"./icons.r1cMsEGh.js";const l=({locationData:t,onClose:n,className:r=""})=>{if(!t||!t.location)return null;const{location:a}=t,o=e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim(),i=e=>"string"==typeof e&&e.length>20,{shortMetrics:l,longMetrics:s}=a.metrics?(e=>{const t=[],n=[];return Object.entries(e).forEach(([e,r])=>{i(r)?n.push([e,r]):t.push([e,r])}),{shortMetrics:t,longMetrics:n}})(a.metrics):{shortMetrics:[],longMetrics:[]};return e.createElement("div",{className:`location-info-card ${r}`},e.createElement("div",{className:"location-info-header"},e.createElement("div",{className:"location-info-title"},e.createElement("h3",null,a.company||"Career Position"),a.role&&e.createElement("p",{className:"location-role"},a.role)),e.createElement("button",{className:"location-close-btn",onClick:n,"aria-label":"Close location info"},e.createElement("span",{className:"close-icon"},"×"))),e.createElement("div",{className:"location-info-content"},e.createElement("div",{className:"location-primary-info"},a.period&&e.createElement("div",{className:"info-item "+(i(a.period)?"full-width":"")},e.createElement("span",{className:"info-label"},"Period"),e.createElement("span",{className:"info-value"},a.period)),a.city&&e.createElement("div",{className:"info-item "+(i(a.city)?"full-width":"")},e.createElement("span",{className:"info-label"},"Location"),e.createElement("span",{className:"info-value"},a.city))),t.desc&&e.createElement("div",{className:"location-description"},e.createElement("p",null,t.desc)),(l.length>0||s.length>0)&&e.createElement("div",{className:"location-metrics"},e.createElement("div",{className:"metrics-grid"},l.map(([t,n])=>e.createElement("div",{key:t,className:"metric-card"},e.createElement("span",{className:"metric-label"},o(t)),e.createElement("span",{className:"metric-value"},n))),s.map(([t,n])=>e.createElement("div",{key:t,className:"metric-card full-width"},e.createElement("span",{className:"metric-label"},o(t)),e.createElement("span",{className:"metric-value"},n))))),a.technologies&&a.technologies.length>0&&e.createElement("div",{className:"location-technologies"},e.createElement("div",{className:"tech-grid"},a.technologies.map((t,n)=>e.createElement("span",{key:n,className:"tech-chip"},t)))),(a.patents||a.certification||a.whitepapers)&&e.createElement("div",{className:"location-additional"},a.patents&&e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"Patents"),e.createElement("span",{className:"info-value"},a.patents)),a.certification&&e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"Certification"),e.createElement("span",{className:"info-value"},a.certification)),a.whitepapers&&e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"Whitepapers"),e.createElement("span",{className:"info-value"},a.whitepapers)))))};l.propTypes={locationData:n.shape({location:n.object,desc:n.string}),onClose:n.func.isRequired,className:n.string};const s=({width:n=null,height:a=null,radius:o=5,rotationSpeed:i=.001,tiltAngle:s=23.5,theme:c="white",enableRotation:u=!1,enableZoom:m=!1,enablePan:d=!1,enableScrollRotation:p=!0,locations:f=[],geoDataUrls:h={countries:"https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson",borders:"https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson"},colors:g={white:{land:16777215,border:0,dot:0,background:16053492},black:{land:0,border:16777215,dot:16777215,background:1710618}},markerConfig:E={size:.05,sizeAttenuation:!0},onMarkerClick:y=null,onMarkerHover:v=null,className:w=""})=>{const b=t.useRef(null),T=t.useRef(null),M=t.useRef(null),S=t.useRef(null),R=t.useRef(null),N=t.useRef(null),I=t.useRef(null),{theme:C,toggleTheme:k}=r(),[A,P]=t.useState(null),[D,L]=t.useState(!0),O="dark"===C?"black":"white",x=t.useRef([]),H=t.useRef([]),z=t.useRef([]),F=t.useCallback(()=>{if(!window.THREE||!b.current)return console.error("Three.js not loaded or mount ref not available"),!1;const e=b.current,t=n||e.clientWidth||e.offsetWidth||800,r=a||e.clientHeight||e.offsetHeight||450,o=new window.THREE.Scene,i=new window.THREE.PerspectiveCamera(75,t/r,.1,1e3),l=new window.THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0});l.setSize(t,r),l.setClearColor(0,0),l.domElement.style.width="100%",l.domElement.style.height="100%",l.domElement.style.display="block",l.domElement.style.margin="0 auto";const c=new window.THREE.Group,p=s*Math.PI/180;if(c.rotation.z=p,o.add(c),i.position.set(0,0,10),window.THREE.OrbitControls){const e=new window.THREE.OrbitControls(i,l.domElement);e.enableRotate=u,e.enablePan=d,e.enableZoom=m,N.current=e}return T.current=o,M.current=l,S.current=i,R.current=c,!0},[n,a,s,u,d,m]),_=t.useCallback(()=>{if(!T.current||!M.current)return;const e=g[O];x.current.forEach(t=>{t.material.color.set(e.land)}),H.current.forEach(t=>{t.material.color.set(e.border)}),z.current.forEach(t=>{t.material.color.set(e.dot)})},[O,g]),j=t.useCallback(e=>{if(!window.THREE||!R.current||!window.earcut)return;const t=[],n=[],r=[];e.forEach((e,a)=>{const i=[];e.forEach(([e,n])=>{const r=(90-n)*Math.PI/180,a=-e*Math.PI/180,l=o*Math.sin(r)*Math.cos(a),s=o*Math.cos(r),c=o*Math.sin(r)*Math.sin(a);t.push(l,s,c),i.push(e,n)}),a>0&&r.push(n.length/2),n.push(...i)});const a=window.earcut(n,r),i=new window.THREE.BufferGeometry;i.setAttribute("position",new window.THREE.Float32BufferAttribute(t,3)),i.setIndex(a);const l=new window.THREE.MeshBasicMaterial({color:g[O].land,side:window.THREE.DoubleSide}),s=new window.THREE.Mesh(i,l);R.current.add(s),x.current.push(s)},[o,O,g]),G=t.useCallback(e=>{window.THREE&&R.current&&e.forEach(e=>{const t=[];if(e.forEach(([e,n])=>{const r=(90-n)*Math.PI/180,a=-e*Math.PI/180,i=o*Math.sin(r)*Math.cos(a),l=o*Math.cos(r),s=o*Math.sin(r)*Math.sin(a);t.push(new window.THREE.Vector3(i,l,s))}),t.length>0){t.push(t[0]);const e=(new window.THREE.BufferGeometry).setFromPoints(t),n=new window.THREE.LineBasicMaterial({color:g[O].border}),r=new window.THREE.Line(e,n);R.current.add(r),H.current.push(r)}})},[o,O,g]),B=t.useCallback(async(e,t=!0)=>{try{const n=await fetch(e);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);(await n.json()).features.forEach(e=>{const n=e.geometry.coordinates;("Polygon"===e.geometry.type?[n]:n).forEach(e=>{t?j(e):G(e)})})}catch(n){if(console.error(`Error loading geo data from ${e}:`,n),t&&R.current){const e=new window.THREE.SphereGeometry(o,32,32),t=new window.THREE.MeshBasicMaterial({color:g[O].land,wireframe:!1}),n=new window.THREE.Mesh(e,t);R.current.add(n),x.current.push(n)}}},[j,G,o,O,g]),$=t.useCallback(()=>{window.THREE&&R.current&&(z.current.forEach(e=>{R.current.remove(e)}),z.current=[],f.forEach(e=>{const t=(90-e.lat)*Math.PI/180,n=-e.lon*Math.PI/180,r=o*Math.sin(t)*Math.cos(n),a=o*Math.cos(t),i=o*Math.sin(t)*Math.sin(n),l=new window.THREE.BufferGeometry;l.setAttribute("position",new window.THREE.Float32BufferAttribute([r,a,i],3));const s=new window.THREE.PointsMaterial({color:g[O].dot,size:E.size,sizeAttenuation:E.sizeAttenuation}),c=new window.THREE.Points(l,s);c.userData={location:e},R.current.add(c),z.current.push(c)}))},[f,o,O,g,E]),U=t.useCallback(e=>{if(!S.current||!z.current.length)return;const t=new window.THREE.Vector2,n=b.current.getBoundingClientRect();t.x=(e.clientX-n.left)/n.width*2-1,t.y=-(e.clientY-n.top)/n.height*2+1;const r=new window.THREE.Raycaster;r.setFromCamera(t,S.current);const a=r.intersectObjects(z.current);if("click"===e.type)if(a.length>0){const t=a[0].object;P(t.userData),y&&y(t.userData,e)}else P(null);else if("mousemove"===e.type)if(a.length>0){const t=a[0].object;v&&v(t.userData,e),b.current.style.cursor="pointer"}else b.current.style.cursor="default",v&&v(null,e)},[y,v]),W=t.useCallback(()=>{T.current&&M.current&&S.current&&(R.current&&i>0&&(R.current.rotation.y+=i),N.current&&N.current.update(),M.current.render(T.current,S.current),I.current=requestAnimationFrame(W))},[i]),Y=t.useCallback(()=>{if(!S.current||!M.current||!b.current)return;const e=b.current,t=n||e.clientWidth||e.offsetWidth||800,r=a||e.clientHeight||e.offsetHeight||450;S.current.aspect=t/r,S.current.updateProjectionMatrix(),M.current.setSize(t,r),M.current.domElement&&(M.current.domElement.style.width="100%",M.current.domElement.style.height="100%",M.current.domElement.style.display="block",M.current.domElement.style.margin="0 auto")},[n,a]),V=t.useCallback(e=>{if(p&&R.current){const t=5e-4*e.deltaY;R.current.rotation.y+=t}},[p]);t.useEffect(()=>{const e=b.current;if(!e)return;(async()=>{if(L(!0),!F())return console.error("Failed to initialize Three.js"),void L(!1);e.appendChild(M.current.domElement),await Promise.all([B(h.countries,!0),B(h.borders,!1)]),$(),_(),W(),L(!1)})(),e&&(e.addEventListener("click",U),e.addEventListener("mousemove",U),e.addEventListener("wheel",V)),window.addEventListener("resize",Y);return new ResizeObserver(()=>{Y()}).observe(e),()=>{if(I.current&&cancelAnimationFrame(I.current),e&&M.current&&e.removeChild(M.current.domElement),e&&(e.removeEventListener("click",U),e.removeEventListener("mousemove",U),e.removeEventListener("wheel",V)),window.removeEventListener("resize",Y),"undefined"!=typeof ResizeObserver){new ResizeObserver(()=>{}).disconnect()}}},[]),t.useEffect(()=>{_()},[_]),t.useEffect(()=>{D||$()},[$,D]),t.useEffect(()=>{Y()},[n,a,Y]);const[q,X]=t.useState(!1);return t.useEffect(()=>{},[]),q?e.createElement("div",{className:`world-globe-container ${w}`,"data-theme":C},e.createElement("div",{className:"globe-loading-fallback"},e.createElement("div",{className:"loading-spinner"}),e.createElement("p",null,"Loading interactive globe..."),e.createElement("p",{style:{fontSize:"0.8rem",marginTop:"0.5rem",opacity:.7}},"Geographic data is loading. The globe will appear shortly."))):e.createElement("div",{className:`world-globe-container ${w}`,"data-theme":C},D&&e.createElement("div",{className:"world-globe-loading"},e.createElement("div",{className:"loading-spinner"}),e.createElement("p",null,"Loading Globe...")),e.createElement("div",{ref:b,className:"world-globe-mount",style:{width:n?`${n}px`:"100%",height:a?`${a}px`:"100%",minHeight:"inherit"}}),e.createElement(l,{locationData:A,onClose:()=>P(null)}))};s.propTypes={width:n.number,height:n.number,radius:n.number,rotationSpeed:n.number,tiltAngle:n.number,theme:n.oneOf(["white","black"]),enableRotation:n.bool,enableZoom:n.bool,enablePan:n.bool,enableScrollRotation:n.bool,locations:n.arrayOf(n.shape({lat:n.number.isRequired,lon:n.number.isRequired,desc:n.string})),geoDataUrls:n.shape({countries:n.string,borders:n.string}),colors:n.shape({white:n.shape({land:n.number,border:n.number,dot:n.number,background:n.number}),black:n.shape({land:n.number,border:n.number,dot:n.number,background:n.number})}),markerConfig:n.shape({size:n.number,sizeAttenuation:n.bool}),onMarkerClick:n.func,onMarkerHover:n.func,className:n.string};const c=[{lat:33.5207,lon:-86.8025,title:"SWE at Intermark Group",company:"Intermark Group",role:"Software Engineer",period:"2016-07 to 2017-05",technologies:["Javascript","SQL","ERP Systems","SOA","Enterprise Integration"],city:"Birmingham, AL",metrics:{projectValue:"$20M ERP",architecture:"SOA migration",teamSize:"3 professionals"}},{lat:33.51364,lon:-86.7832,title:"Technical Consultant at PNC",company:"PNC Bank",role:"Technical Consultant",period:"2017-05 to 2017-11",technologies:["EMV","Payment Processing","Banking Systems","MongoDB","Express.js","Node.js"],city:"Birmingham, AL",metrics:{teamSize:"4 developers",integration:"Harland Clarke",cardTypes:"EMV enabled"}},{lat:34.11121,lon:-84.20606,title:"Lead Software Engineer at BLOCNETS, INC.",company:"BLOCNETS, INC.",role:"Lead Software Engineer",period:"2018-03 to 2019-04",technologies:["Hyperledger Fabric","Smart Contracts","Intel SGX","3D Printing Security","Cryptography"],city:"Alpharetta, GA",metrics:{funding:"$1.8M secured",printerModels:"67 supported",patents:"1 provisional"}},{lat:33.749,lon:-84.388,title:"Solutions Architect at You42",company:"You42",role:"Solutions Architect",period:"2019-04 to 2021-02",technologies:["AWS","Node.js","React","Go","Microservices Architecture"],city:"Atlanta, GA",metrics:{teamSize:"5 developers",deliveryTime:"6 months MVP",architecture:"Microservices"}},{lat:34.7304,lon:-86.5861,title:"Fractional CTO at cryptstax",company:"cryptstax",role:"Owner",period:"2019-11 to 2025-Present",technologies:["Blockchain","Cryptocurrency","Tax Compliance","Distributed Systems","Python"],city:"Huntsville, AL",metrics:{uptime:"99.9%",transactions:"1M+ processed",clients:"Enterprise scale"}},{lat:33.4484,lon:-82.1571,title:"Senior Software Engineer at NCR Global",company:"NCR Global",role:"Senior Software Engineer",period:"2021-02 to 2021-10",technologies:["Microservices","Cloud Architecture","DevOps","Docker","Kubernetes"],city:"Atlanta, GA",metrics:{solutions:"Cloud-native",sectors:"Retail & Finance",subcontractor:"Optomi | IT Talent Services"}},{lat:51.5074,lon:-.1278,title:"IPFS Engineer at Privi Protocol",company:"Privi Protocol",role:"Blockchain Consultant",period:"3 months",technologies:["Bitcoin","IPFS","DeFi","Payment Systems"],city:"London, UK",metrics:{sector:"Web3",industry:"DeFi",subcontractor:"Plexus Resource Solutions"}},{lat:36.1659,lon:-86.7844,title:"Chief Technology Officer at Fathom PBC",company:"Fathom PBC",role:"Co-Founder",period:"2020-12 to 2025-06",technologies:["Python","Aries","P2P","Docker","Node.js"],city:"Nashville, TN",metrics:{patents:"1+ contributed",certification:"Aries certified",whitepapers:"3+ published"}},{lat:38.6609,lon:-90.4226,title:"DevSecOps Engineer at Object Computing, Inc.",company:"Object Computing, Inc.",role:"DevSecOps Engineer",period:"2022-07 to 2023-05",technologies:["DevOps","Security","CI/CD","Cloud Infrastructure"],city:"St. Louis, MO",metrics:{grantValue:"HBAR Foundation",infrastructure:"Terraform IaaC",platform:"GCP OpenSearch"}},{lat:39.742043,lon:-104.991531,title:"Techstars Workforce Development Accelerator (2024)",company:"Techstars",role:"Accelerator Participant",period:"2024-06 to 2024-09",technologies:["Entrepreneurship","Workforce Development","Startup"],city:"Denver, CO"}],u="INITIALIZE_TIMELINE",m="SET_CURRENT_INDEX",d="START_DRAG",p="UPDATE_DRAG",f="END_DRAG",h="SET_SNAPPING",g="SET_RAIL_OFFSET",E="UPDATE_MOMENTUM",y="SET_AUTO_SCROLLING",v="SET_PERFORMANCE_DEGRADED",w="UPDATE_RAIL_PERFORMANCE",b="RESET_DRAG_STATE",T="CALCULATE_MOMENTUM_TARGET",M={currentIndex:-1,isAutoScrolling:!1,scrollOffset:0,isDragging:!1,dragStart:{x:0,offset:0},dragOffset:0,momentum:{velocity:0,timestamp:0},isSnapping:!1,isRailMode:!0,railOffset:0,railPerformanceMetrics:{renderTime:0,visibleItems:0,recycledItems:0,fps:60,memoryUsage:0},performanceDegraded:!1,momentumTarget:null},S=(e,t)=>{switch(t.type){case u:const{timelineData:n,persistedState:r}=t.payload;if(-1!==e.currentIndex)return e;if(e.isDragging||e.isSnapping||0!==e.railOffset||0!==e.dragOffset)return e;if(null==r?void 0:r.selectedYear){const t=n.findIndex(e=>e.date===r.selectedYear);if(-1!==t)return{...e,currentIndex:t}}return{...e,currentIndex:-1};case m:return t.payload<0?e:{...e,currentIndex:t.payload};case d:return{...e,isDragging:!0,dragStart:t.payload.dragStart,railOffset:0,dragOffset:0,momentum:{velocity:0,timestamp:t.payload.timestamp},isSnapping:!1};case p:return{...e,railOffset:t.payload.railOffset,momentum:t.payload.momentum};case f:return{...e,isDragging:!1,isSnapping:t.payload.shouldSnap||!1,dragOffset:0};case h:return{...e,isSnapping:t.payload};case g:return{...e,railOffset:t.payload};case E:return{...e,momentum:t.payload};case y:return{...e,isAutoScrolling:t.payload};case v:return{...e,performanceDegraded:t.payload};case w:return{...e,railPerformanceMetrics:{...e.railPerformanceMetrics,...t.payload}};case T:const{timelineLength:a,itemSpacing:o}=t.payload,{velocity:i}=e.momentum,l=.5;if(!(Math.abs(i)>l))return{...e,momentumTarget:null};const s=i*(Math.abs(i)>1?.4:.2),c=(s>0?Math.pow(s,.8):-Math.pow(Math.abs(s),.8))*o*2.5;let M=e.currentIndex;if(-1===M){const t=-e.railOffset/o;M=Math.max(0,Math.min(a-1,Math.round(Math.floor(a/2)+t)))}const S=Math.round(c/o);let R=M+S;return(R<0||R>=a)&&(0===S?R=M:R<0?R=a-1:R>=a&&(R=0)),{...e,momentumTarget:R};case b:return{...e,isDragging:!1,isSnapping:!1,dragOffset:0,railOffset:0,momentum:{velocity:0,timestamp:0},momentumTarget:null};default:return e}},R=({onYearChange:n})=>{const r=t.useRef(null),o=t.useRef(null),l=t.useRef(null),s=t.useRef({x:0,timestamp:0}),E=t.useRef(null),[b,R]=t.useReducer(S,M),{currentIndex:N,isAutoScrolling:I,scrollOffset:C,isDragging:k,dragStart:A,dragOffset:P,momentum:D,isSnapping:L,isRailMode:O,railOffset:x,railPerformanceMetrics:H,performanceDegraded:z}=b,F=t.useRef(null),_=t.useRef(new Map),j=t.useRef({startIndex:0,endIndex:0,viewportWidth:0,itemWidth:152}),G=t.useRef(null),B=t.useMemo(()=>{const e=[],t=new Set;return c.forEach(n=>{var r;const a=null==(r=n.period.match(/(\d{4})/))?void 0:r[1];a&&!t.has(a)&&(t.add(a),e.push({id:`career-${n.company}`,type:"career",date:a,title:n.title,company:n.company,period:n.period}))}),a.projects.allIds.forEach(n=>{const r=a.projects.byId[n],o=r.createdAt.split("-")[0];t.has(o)||(t.add(o),e.push({id:`project-${n}`,type:"project",date:o,title:r.title}))}),e.sort((e,t)=>parseInt(e.date)-parseInt(t.date))},[]),$=t.useRef(null);t.useEffect(()=>{"undefined"==typeof window||$.current||i(async()=>{const{usePerformanceMonitor:e}=await import("./index.BLRXELsa.js").then(e=>e.d);return{usePerformanceMonitor:e}},__vite__mapDeps([0,1,2,3])).then(({usePerformanceMonitor:e})=>{G.current={record:(e,t)=>{var n;(null==(n=$.current)?void 0:n.record)&&$.current.record(`timeline-rail-${e}`,{...t,railMode:O,railOffset:x,performanceMetrics:H})}}})},[O,x,H]);const U=t.useCallback(()=>{const e=`${x}-${window.innerWidth}`;if(_.current.has(e))return _.current.get(e);const t=window.innerWidth,n=j.current.itemWidth,r=t/2,a=Math.max(0,Math.floor((x-r-3*n)/n)),o=Math.min(B.length-1,Math.ceil((x+r+3*n)/n)),i={startIndex:a,endIndex:o,visibleCount:o-a+1,totalItems:B.length};if(_.current.set(e,i),_.current.size>50){const e=_.current.keys().next().value;_.current.delete(e)}return i},[x,B.length]),W=t.useMemo(()=>{var e;const t=performance.now(),n=B.length>20,r=n?U():null,a=B.slice(n?r.startIndex:0,n?r.endIndex+1:void 0).map((e,t)=>{const a=n?r.startIndex+t:t;return{...e,railPosition:a,railIndex:a,virtualIndex:t,distanceFromCenter:Math.abs(a-Math.floor(B.length/2)),shouldUseGPU:!0,isVirtual:n}}),o=performance.now()-t;return R({type:w,payload:{renderTime:o,visibleItems:a.length,recycledItems:n?B.length-a.length:0}}),(null==(e=G.current)?void 0:e.record)&&G.current.record("rail-render",{renderTime:o,itemCount:a.length,totalItems:B.length,useVirtualScrolling:n}),a},[B,U]),Y=t.useCallback(()=>{"vibrate"in navigator&&navigator.vibrate(10)},[]),V=t.useCallback(e=>{if(!r.current||0===B.length)return;R({type:y,payload:!0}),R({type:h,payload:!0});let t=e;t<0?t=B.length-1:t>=B.length&&(t=0),t!==N&&Y();const n=r.current;n&&(n.style.transition="transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94)",requestAnimationFrame(()=>{n.style.transform="translateX(0px)"})),R({type:m,payload:t}),setTimeout(()=>{R({type:y,payload:!1}),R({type:h,payload:!1}),n&&(n.style.transition="",n.style.transform="")},600)},[B.length,N,Y]),q=t.useCallback(e=>{console.log("Timeline: Dot clicked",{targetIndex:e,wasInteracted:J.current}),J.current=!0,V(e)},[V]),X=t.useCallback(e=>{if("ArrowLeft"===e.key){e.preventDefault();const t=-1===N?Math.floor(B.length/2)-1:N-1;V(t)}else if("ArrowRight"===e.key){e.preventDefault();const t=-1===N?Math.floor(B.length/2)+1:N+1;V(t)}},[N,V,B.length]),Z=t.useRef(!1),J=t.useRef(!1);t.useEffect(()=>{if(B.length>0&&!Z.current){Z.current=!0;const e="undefined"!=typeof window?(()=>{try{const e=localStorage.getItem("timelineState");return e?JSON.parse(e):{}}catch{return{}}})():{};console.log("✅ Timeline: ONE-TIME initialization with persisted state:",e),R({type:u,payload:{timelineData:B,persistedState:e}})}},[B.length]),t.useEffect(()=>{if("undefined"!=typeof window&&N>=0&&B[N]&&Z.current){const e={selectedYear:B[N].date};console.log("💾 Timeline: Saving state to localStorage:",e,{currentIndex:N,hasInitialized:Z.current,triggerReason:"currentIndex changed after initialization"}),localStorage.setItem("timelineState",JSON.stringify(e))}},[N,B]),t.useEffect(()=>{null!==b.momentumTarget&&(R({type:g,payload:0}),V(b.momentumTarget),R({type:T,payload:{timelineLength:0,itemSpacing:0}}))},[b.momentumTarget,V]),t.useEffect(()=>{if(n)if(N>=0&&B[N]){const e=B[N].date;console.log("Timeline year change:",e,{currentIndex:N,hasInitialized:Z.current,timelineDataLength:B.length}),n(e)}else-1===N&&(Z.current?console.warn("⚠️ Timeline: currentIndex is -1 but hasInitialized is true - this should not happen!",{currentIndex:N,hasInitialized:Z.current,timelineDataLength:B.length}):(console.log("Timeline year change: null (not yet initialized)"),n(null)))},[N,B,n]);const K=t.useCallback(e=>{var t;if(L)return;const n="touchstart"===e.type?e.touches[0].clientX:e.clientX;e.preventDefault(),e.stopPropagation(),"touchstart"===e.type&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),console.log("🖱️ Timeline: Drag started",{wasInteracted:J.current,currentIndex:N,currentYear:null==(t=B[N])?void 0:t.date,clientX:n,isSnapping:L,isDragging:k,railOffset:x,resettingRailOffset:"rail will be reset to 0"}),J.current=!0,R({type:d,payload:{dragStart:{x:n,offset:0},timestamp:Date.now()}}),s.current={x:n,timestamp:Date.now()},l.current&&cancelAnimationFrame(l.current),E.current&&clearTimeout(E.current);const r=o.current;r&&(r.style.cursor="grabbing"),Y()},[L,Y,N,B,k,x]),Q=t.useCallback(e=>{var t;if(!k||L)return;e.preventDefault(),e.stopPropagation();const n="touchmove"===e.type?e.touches[0].clientX:e.clientX,r=n-A.x,a=performance.now();H.fps<30&&(R({type:v,payload:!0}),(null==(t=G.current)?void 0:t.record)&&G.current.record("performance-fallback",{reason:"low-fps",fps:H.fps})),z||(F.current&&cancelAnimationFrame(F.current),F.current=requestAnimationFrame(()=>{const e=window.innerWidth<=768,t=r*(e?.9:.8),o=-1===N?Math.floor(B.length/2):N,i=-t/152;let l=Math.round(o+i);l<0?l=B.length+l%B.length:l>=B.length&&(l%=B.length);const c=Date.now(),u=c-s.current.timestamp;let m=0;if(u>0){const e=(n-s.current.x)/u,t=.7;m=D.velocity*(1-t)+e*t}R({type:p,payload:{railOffset:t,momentum:{velocity:m,timestamp:c}}});const d=performance.now()-a;R({type:w,payload:{renderTime:Math.max(H.renderTime,d)}})}));const o=Date.now();s.current={x:n,timestamp:o}},[k,A,L,D.velocity,H.fps,H.renderTime,z,N,B.length]),ee=t.useCallback(()=>{var e,t,n,r;if(!k)return;document.body.style.overflow="",document.documentElement.style.overflow="";const a=o.current;a&&(a.style.cursor="grab");const i=-1===N?Math.floor(B.length/2):N,l=-x/152;let s=Math.round(i+l);s<0?s=B.length+s%B.length:s>=B.length&&(s%=B.length),console.log("🏁 Timeline: Drag ended",{currentIndex:N,currentYear:null==(e=B[N])?void 0:e.date,railOffset:x,railOffsetInItems:l,finalIndex:s,finalYear:null==(t=B[s])?void 0:t.date,willUpdateIndex:s!==N,hasUserInteracted:J.current}),R({type:g,payload:0}),s!==N&&s>=0&&s<B.length&&(console.log("📍 Timeline: Updating index after drag",{from:N,to:s,fromYear:null==(n=B[N])?void 0:n.date,toYear:null==(r=B[s])?void 0:r.date}),R({type:m,payload:s})),R({type:T,payload:{timelineLength:B.length,itemSpacing:152}}),R({type:f,payload:{shouldSnap:null!==b.momentumTarget}}),null!==b.momentumTarget&&(E.current=setTimeout(()=>{R({type:h,payload:!1})},600))},[k,B.length,b.momentumTarget,N,x,B]);t.useEffect(()=>{let e=0,t=performance.now();const n=()=>{var r,a;e++;const o=performance.now();if(o-t>=1e3){const n=Math.round(1e3*e/(o-t));R({type:w,payload:{fps:n}}),n<30&&(R({type:v,payload:!0}),(null==(r=G.current)?void 0:r.record)&&G.current.record("performance-warning",{fps:n,memoryUsage:(null==(a=performance.memory)?void 0:a.usedJSHeapSize)||0,renderTime:H.renderTime})),e=0,t=o}z||requestAnimationFrame(n)},r=requestAnimationFrame(n);return()=>{cancelAnimationFrame(r)}},[z,H.renderTime]),t.useEffect(()=>{const e=_.current,t=setInterval(()=>{var e;if(performance.memory){const t=performance.memory.usedJSHeapSize;R({type:w,payload:{memoryUsage:t}});const n=t/performance.memory.jsHeapSizeLimit;n>.8&&(R({type:v,payload:!0}),(null==(e=G.current)?void 0:e.record)&&G.current.record("memory-pressure",{memoryUsage:t,memoryPressure:Math.round(100*n)}))}},2e3);return()=>{clearInterval(t),e.clear()}},[]),t.useEffect(()=>{const e=r.current,t=o.current;if(!e||!t)return;Z.current;const n=l.current,a=F.current;e.addEventListener("keydown",X),e.setAttribute("tabindex","0"),t.addEventListener("mousedown",K),t.addEventListener("touchstart",K,{passive:!1});const i=e=>Q(e),s=e=>Q(e),c=()=>ee(),u=()=>ee();return document.addEventListener("mousemove",i),document.addEventListener("touchmove",s,{passive:!1}),document.addEventListener("mouseup",c),document.addEventListener("touchend",u),document.addEventListener("touchcancel",u),()=>{e.removeEventListener("keydown",X),t.removeEventListener("mousedown",K),t.removeEventListener("touchstart",K),document.removeEventListener("mousemove",i),document.removeEventListener("touchmove",s),document.removeEventListener("mouseup",c),document.removeEventListener("touchend",u),document.removeEventListener("touchcancel",u),n&&cancelAnimationFrame(n),a&&cancelAnimationFrame(a),E.current&&clearTimeout(E.current),_.current.clear()}},[X,K,Q,ee]);const te=t.useCallback(()=>{performance.now();const t=152,n=window.innerWidth/2,r=(window.innerWidth,window.innerWidth,N>=0?N:Math.floor(B.length/2));return W.map((a,o)=>{const i=a.railIndex,l=(i-r)*t,s=`translate3d(${l+x}px, 0, 0)`,c=n+l+x,u=Math.abs(c-n);let m="distant",d=!1;i===r&&Math.abs(x)<76||u<t/3?(m="center",d=!0):u<t&&(m="adjacent");return Math.abs(c-n)>window.innerWidth&&B.length>20?null:e.createElement("div",{key:`rail-${i}`,className:`timeline-section ${m} ${d?"active":""} rail-optimized`,"data-year":a.date,"data-rail-position":i,"data-virtual-index":o,onClick:()=>q(i),"aria-label":`Navigate to ${a.date} - ${a.title||a.company||"Timeline item"}`,"aria-current":d?"true":"false",role:"button",tabIndex:"0",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),q(i))},style:{transform:s,willChange:"transform",position:"absolute",left:"50%",marginLeft:"-60px",transition:"none",zIndex:d?60:52,backfaceVisibility:"hidden",perspective:1e3,transformStyle:"preserve-3d"}},e.createElement("span",{className:"timeline-dot"}),e.createElement("span",{className:"timeline-year","data-debug-year":a.date,"data-debug-active":d},a.date))}).filter(Boolean)},[W,x,q,B.length]);return e.createElement("div",{className:"timeline-wrapper"},e.createElement("div",{className:"timeline-container",ref:r},e.createElement("div",{className:`timeline-scroll rail-active ${k?"dragging":""} ${L?"snapping":""}`,ref:o},e.createElement("div",{className:"timeline-center-indicator"}),e.createElement("div",{className:"timeline-items-container rail-mode"},te()))))};R.propTypes={onYearChange:n.func};const N=e.memo(()=>{o();const[n,r]=t.useState(null),[a,i]=t.useState(null),u=t.useCallback(e=>{if(console.log("Timeline year change:",e),!e||null===e)return r(null),void i(null);r(e);const t=c.find(t=>{var n;return(null==(n=t.period.match(/(\d{4})/))?void 0:n[1])===e});i(t||null)},[]);return t.useEffect(()=>{const e=e=>{if(!a)return;const t=document.querySelector(".world-globe-info"),n=document.querySelector(".portfolio-timeline-section");if(t&&n){const r=t.contains(e.target),a=n.contains(e.target);r||a||i(null)}};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[a]),e.createElement("section",{id:"portfolio",className:"section section-alt"},e.createElement("div",{className:"container"},e.createElement("h2",{className:"section-title"},"PORTFOLIO"),e.createElement("div",{className:"portfolio-globe-section"},e.createElement("div",{className:"portfolio-globe"},e.createElement(e.Suspense,{fallback:e.createElement("div",{className:"globe-loading-fallback"},e.createElement("div",{className:"loading-spinner"}),e.createElement("p",null,"Loading interactive globe..."))},e.createElement(s,{enableRotation:!0,enableZoom:!1,enableScrollRotation:!0,locations:c,colors:{white:{land:16777215,border:0,dot:16711680,background:0},black:{land:0,border:16777215,dot:16711680,background:0}}})),e.createElement(l,{locationData:a?{location:a}:null,onClose:()=>{r(null),i(null)}})),e.createElement("div",{className:"portfolio-timeline-section"},e.createElement(R,{onYearChange:u})))))});export{N as Portfolio};
